<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@100;400;700&display=swap" rel="stylesheet">
    <title>Sales tax calculator</title>
</head>

<style>
    body {
        font-family: 'Lato', sans-serif;
    }

    .divBasket {
        margin-left: auto;
        margin-right: auto;
        width: 25%;
    }

    .div_inputs{
        background-color: ddd;
        color: black;
        margin-bottom: 20px;
        padding: 10px;
    }

    .add_to_cart_btn{
        background-color: aquamarine;
        padding: 5px 10px;
        margin: 10px;
    }
</style>

<body>
    <button id="buyBtn">Buy!</button>
    <div style="display: flex">
        <div class="divBasket" id="basket1">
            <h3>Basket1</h3>
        </div>

        <div class="divBasket" id="basket2">
            <h3>Basket2</h3>
        </div>

        <div class="divBasket" id="basket3">
            <h3>Basket3</h3>
        </div>
    </div>
</body>

</html>

<script>

    //get the data of each items from the controller
    $("#buyBtn").on("click", function () {
        $.get("SalesTaxCalculator.php", function (data, status) {
            alert("Data: " + data + "\nStatus: " + status);

            var parsedValues = JSON.parse(data);

            if (status == "success") {
                var append = "";

                $.each(parsedValues, function (parsedK, parsedV) {
                    $.each(parsedV, function (key, value) {
                        var formName = "form_" + parsedK + "_" + key;
                        
                        append += "<form name=" + formName + " id=" + formName + ">";
                        append += "<div class='div_inputs'>";

                        $.each(value, function (k, v) {
                            append += "<span>";
                            append += "<b>" + k + "</b>: " + v;
                            append += "</span>";
                            append += "<input type='hidden' name='" + k + "' value='" + v + "'>";

                            append += "<br>";
                        });

                        var formData = $("#" + formName).serialize();

                        console.log(formData);
                        

                        append += "<button class='add_to_cart_btn' id='addToCartBtn' onclick='addToCart(" + formData + ")'>Add to cart</button>";

                        append += "</div>";
                        append += "<br>";
                        append += "</form>";
                    });

                    $("#" + parsedK).append(append);

                    append = "";
                });
            }
        });
    });

    function addToCart(formData){
        console.log("addToCart");
        
        console.log(formData);
    }


</script>